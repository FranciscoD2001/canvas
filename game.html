
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf8">
    <meta name="viewport" content="width=devive-width,
    initial-scale=1">
    <title>
        Canvas
    </title>
    <style type="text/css">
        canvas{
            background-color: rgb(255, 255, 255);

    }
    </style>
    
</head>
<body>
    <canvas id="mycanvas" width="1000" height="800">
        Hola tu navegador no funciona
    </canvas>

    <img id="imagen" src="Ghost.jpg" style="display:none">

    <script type="text/javascript">
        var cv = null
        var ctx = null 

        var press = false;

        var super_x = 0;
        var super_y = 0;   
        var player1 = null
        var player2 = null
        var direccion = "right"
        var speed = 2
        var score = 0

        document.addEventListener('keydown',function(e){
            console.log(e)

            if(e.key == "w" || e.key == "ArrowUp"){
                // super_y -= 5;
                direccion = "up"
            }

            if(e.key == "s" || e.key == "ArrowDown"){
                // super_y += 5;
                direccion = "down"
            }

            if(e.key == "a" || e.key == "ArrowLeft"){
                // super_x -= 5;
                direccion = "left"
            }

            if(e.key == "d" || e.key == "ArrowRight"){
                // super_x += 5;
                direccion = "right"
            }
            paint();
        })

        function paint(){
            window.requestAnimationFrame(paint)

            ctx.fillStyle = "blue";
            ctx.fillRect(0,0,1000,800);
            // ctx.fillStyle = randomColor();
            // ctx.fillRect(super_x, super_y, 40,40);

            ctx.fillStyle = "white";
            ctx.fillText("SCORE: "+score,250,250);

            player1.pintar(ctx)
            player2.pintar(ctx)

            update()
            
        }

        function update(){

            if(direccion == "up"){
                player1.y -= speed
                if(player1.y<0){
                    player1.y = 800;
                }
            }

            if(direccion == "down"){
                player1.y += speed
                if(player1.y>800){
                    player1.y = 0;
                }
            }

            if(direccion == "left"){
                player1.x -= speed
                if(player1.x<0){
                    player1.x = 1000;
                }
            }

            if(direccion == "right"){
                player1.x += speed
                if(player1.x>1000){
                    player1.x = 0;
                }
            }


            if(player1.se_tocan(player2)){
                player2.x = getRandom(1000)
                player2.y = getRandom(800)
                score += 1
            }



            // player1.x+=2;  

            // if(player1.x>1000){
            //     player1.x = 0;
            // }
        }

        function Cuadro(x,y,w,h,c){
            this.x = x;
            this.y = y
            this.w = w
            this.h = h
            this.c = c

            this.se_tocan = function (target) { 
                if(this.x < target.x + target.w &&
                    this.x + this.w > target.x && 
                    this.y < target.y + target.h && 
                    this.y + this.h > target.y)
                    {
                        return true;	 
                        console.log("hola")
                    }  
            };

            this.pintar = function(ctx){
                ctx.fillStyle = this.c
                ctx.fillRect(this.x,this.y,this.w,this.h)
                ctx.strokeRect(this.x,this.y,this.w,this.h)
            }
        }

        window.requestAnimationFrame = (function () {
            return window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                function (callback) {
                    window.setTimeout(callback, 17);
                };
        }());

        window.addEventListener("load", run(), false)       

        function random(number){
            return Math.floor(Math.random()*number);
        }

        function randomColor(){
            return 'rgba('+random(255)+','+random(255)+','+random(255)+',0.5)';    
        }

        function getRandom(max){
            return Math.floor(Math.random()*max)
        }

        function run(){
            cv = document.getElementById('mycanvas');
            ctx = cv.getContext('2d');

            player1 = new Cuadro(0,0,40,40, "red")
            player2 = new Cuadro(getRandom(1000),getRandom(800), 40, 40, "white")

            paint()
        }

    </script>

</body>
</html>